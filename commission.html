<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Commission Artwork — Daria Avdeeva</title>
  <meta name="description" content="Request a custom commission by Daria Avdeeva" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-neutral-50 text-neutral-900 antialiased">
  <header class="sticky top-0 z-30 bg-white/80 backdrop-blur border-b">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-9 h-9 rounded-full bg-neutral-900 text-white grid place-content-center font-semibold">DA</div>
        <a href="./index.html" class="text-lg font-semibold leading-tight"> Daria <br class="sm:hidden"/> Avdeeva </a>
      </div>
     <nav class="flex items-center gap-4 text-sm overflow-x-auto whitespace-nowrap">
        <a href="./gallery.html" class="hover:opacity-70">All <br class="sm:hidden"/>Works</a>
        <a href="./about.html" class="hover:opacity-70">About <br class="sm:hidden"/>Daria</a>
        <a href="./commission.html" class="hover:opacity-70">Commission <br class="sm:hidden"/>Artwork</a>
      </nav>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-10">
    <section class="mb-8">
      <h1 class="text-3xl font-bold mb-2">Commission an Artwork</h1>
      <p class="text-neutral-700">
        Looking for a custom piece—portrait, still life, or a concept tailored to your space? Share a few details below. Daria will reply with timelines, pricing, and next steps.
      </p>
      <div class="mt-4 grid md:grid-cols-3 gap-3 text-sm text-neutral-700">
        <div class="rounded-xl border bg-white p-4">
          <h3 class="font-semibold mb-1">1. Vision & Reference</h3>
          <p>Describe the subject, mood, palette, and share any reference images or a work from the gallery you like.</p>
        </div>
        <div class="rounded-xl border bg-white p-4">
          <h3 class="font-semibold mb-1">2. Proposal</h3>
          <p>We’ll align on size, medium, price, and timeline. A deposit confirms the commission.</p>
        </div>
        <div class="rounded-xl border bg-white p-4">
          <h3 class="font-semibold mb-1">3. Creation & Delivery</h3>
          <p>Regular progress updates. Drying/varnishing times depend on medium. Pickup or shipping arranged.</p>
        </div>
      </div>
    </section>

    <section class="rounded-2xl border bg-white p-6">
      <h2 class="text-xl font-semibold mb-3">Request form</h2>

      <!-- Status message -->
      <div id="cf_status" class="hidden mb-3 rounded-xl border px-4 py-3 text-sm"></div>

      <form id="commissionForm" class="grid md:grid-cols-2 gap-4" autocomplete="on" novalidate>
        <!-- Honeypot -->
        <div class="hidden" aria-hidden="true">
          <label>Leave this field empty</label>
          <input type="text" id="cf_hp" name="company" tabindex="-1" autocomplete="off" />
        </div>

        <div>
          <label class="block text-sm text-neutral-600 mb-1">Your name</label>
          <input id="cf_name" name="name" class="w-full px-3 py-2 border rounded-xl bg-white" required />
        </div>
        <div>
          <label class="block text-sm text-neutral-600 mb-1">Email</label>
          <input id="cf_email" name="email" type="email" class="w-full px-3 py-2 border rounded-xl bg-white" required />
        </div>
        <div>
          <label class="block text-sm text-neutral-600 mb-1">Phone (optional)</label>
          <input id="cf_phone" name="phone" class="w-full px-3 py-2 border rounded-xl bg-white" />
        </div>
        <div>
          <label class="block text-sm text-neutral-600 mb-1">Target size (cm)</label>
          <input id="cf_size" name="size" placeholder="e.g., 60 × 80" class="w-full px-3 py-2 border rounded-xl bg-white" />
        </div>

        <div class="md:col-span-2">
          <label class="block text-sm text-neutral-600 mb-1">Medium preference</label>
          <select id="cf_medium" name="medium" class="w-full px-3 py-2 border rounded-xl bg-white">
            <option value="">Open to suggestions</option>
            <option>Oil on Canvas</option>
            <option>Charcoal on Paper</option>
          </select>
        </div>

        <div class="md:col-span-2">
          <label class="block text-sm text-neutral-600 mb-1">Reference (optional)</label>
          <select id="cf_reference" name="reference" class="w-full px-3 py-2 border rounded-xl bg-white">
            <option value="">— Select from gallery (optional) —</option>
          </select>
        </div>

        <div class="md:col-span-2">
          <label class="block text-sm text-neutral-600 mb-1">Describe your idea</label>
          <textarea id="cf_notes" name="notes" rows="5" class="w-full px-3 py-2 border rounded-xl bg-white" placeholder="Tell us about the subject, colors, mood, deadline, and any special requests…" required></textarea>
        </div>

        <div class="md:col-span-2 flex gap-3 items-center">
          <button id="cf_submit" class="px-4 py-2 rounded-2xl bg-neutral-900 text-white disabled:opacity-60" type="submit">
            <span id="cf_submit_text">Send request</span>
            <span class="hidden" id="cf_submit_loading">Sending…</span>
          </button>
          <a href="mailto:artist.dariaavd@gmail.com" class="px-4 py-2 rounded-2xl border">Email directly</a>
        </div>
      </form>
    </section>

    <section class="mt-8">
      <div class="rounded-2xl border bg-white p-6">
        <h3 class="text-xl font-semibold mb-2">Contact</h3>
        <p>Email: <a href="mailto:artist.dariaavd@gmail.com" class="underline">artist.dariaavd@gmail.com</a></p>
        <p>Instagram: <a href="https://instagram.com/dariadrawsart" class="underline">@dariadrawsart</a></p>
        <p>Mobile: 0563443141</p>
      </div>
    </section>
  </main>

  <footer class="py-10 text-center text-sm text-neutral-500">© <span id="year"></span> Daria Avdeeva. All rights reserved.</footer>

  <script src="./artworks.js"></script>
  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // Populate reference dropdown
    (window.ARTWORKS || []).forEach(a => {
      const opt = document.createElement('option');
      opt.value = a.title;
      opt.textContent = a.title;
      document.getElementById('cf_reference').appendChild(opt);
    });

    const FORMSPREE_ENDPOINT = "https://script.google.com/macros/s/AKfycbyj1EHd-3vap0ubvaRjHHiYiyvT4gBelXJJxzkbuxLZq0nIsjBv1nzIJIJtUvnAQxlV/exec";

    const form = document.getElementById('commissionForm');
    const statusBox = document.getElementById('cf_status');
    const submitBtn = document.getElementById('cf_submit');
    const submitText = document.getElementById('cf_submit_text');
    const submitLoading = document.getElementById('cf_submit_loading');

    function setLoading(isLoading) {
      submitBtn.disabled = isLoading;
      submitText.classList.toggle('hidden', isLoading);
      submitLoading.classList.toggle('hidden', !isLoading);
    }

    function showStatus(message, ok = true) {
      statusBox.textContent = message;
      statusBox.className = "mb-3 rounded-xl border px-4 py-3 text-sm " +
        (ok ? "bg-green-50 border-green-300 text-green-800" : "bg-red-50 border-red-300 text-red-800");
      statusBox.classList.remove('hidden');
    }

    function buildPayload() {
      return {
        name: document.getElementById('cf_name').value.trim(),
        email: document.getElementById('cf_email').value.trim(),
        phone: document.getElementById('cf_phone').value.trim(),
        size: document.getElementById('cf_size').value.trim(),
        medium: document.getElementById('cf_medium').value.trim(),
        reference: document.getElementById('cf_reference').value.trim(),
        notes: document.getElementById('cf_notes').value.trim(),
        _subject: `Commission request — ${document.getElementById('cf_name').value.trim() || 'New lead'}`
      };
    }

    function fallbackToMailto(payload) {
      const to = "artist.dariaavd@gmail.com";
      const subject = payload._subject;
      const bodyLines = [
        `Name: ${payload.name}`,
        `Email: ${payload.email}`,
        payload.phone ? `Phone: ${payload.phone}` : null,
        payload.size ? `Target size: ${payload.size}` : null,
        payload.medium ? `Medium preference: ${payload.medium}` : null,
        payload.reference ? `Reference: ${payload.reference}` : null,
        "",
        "Project details:",
        payload.notes || ""
      ].filter(Boolean);

      window.location.href = `mailto:${encodeURIComponent(to)}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(bodyLines.join("\n"))}`;
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      if (document.getElementById('cf_hp').value) {
        showStatus("Thanks! Your request has been received.", true);
        form.reset();
        return;
      }

      const payload = buildPayload();
      setLoading(true);
      showStatus("");

      try {
        const res = await fetch(FORMSPREE_ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "application/json", "Accept": "application/json" },
          body: JSON.stringify(payload),
        });

        if (res.ok) {
          showStatus("Thank you! Your request was sent successfully.", true);
          form.reset();
        } else {
          showStatus("Couldn’t send via the site. Opening your email app instead…", false);
          fallbackToMailto(payload);
        }
      } catch {
        showStatus("Network issue. Opening your email app instead…", false);
        fallbackToMailto(payload);
      } finally {
        setLoading(false);
      }
    });
  </script>
</body>
</html>
